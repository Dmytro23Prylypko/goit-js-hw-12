{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../assets/error.png","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst PIXABAY_BASE_URL = 'https://pixabay.com/api/';\nconst PIXABAY_API_KEY = '49352889-932a02498e450d158832440ce';\n\naxios.defaults.baseURL = PIXABAY_BASE_URL;\n\nexport const fetchImages = async (query, page, perPage) => {\n  const response = await axios.get('', {\n    params: {\n      key: PIXABAY_API_KEY,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page,\n      per_page: perPage,\n    },\n  });\n\n  return response.data;\n};\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst gallery = document.querySelector('.gallery');\n\nexport function getGalleryItems(items) {\n  const lishtBox = new SimpleLightbox('.gallery li a', {});\n\n  items = items\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n        <li>\n          <a href=\"${largeImageURL}\">\n            <img src=\"${webformatURL}\" alt=\"${tags}\"/>\n          </a>\n          <ul class=\"gallery-info\">\n            <li>\n              <span class=\"gallery-info-subtitle\">Likes</span>\n              <span>${likes}</span>\n            </li>\n            <li>\n              <span class=\"gallery-info-subtitle\">Views</span>\n              <span>${views}</span>\n            </li>\n            <li>\n              <span class=\"gallery-info-subtitle\">Comments</span>\n              <span>${comments}</span>\n            </li>\n            <li>\n              <span class=\"gallery-info-subtitle\">Downloads</span>\n              <span>${downloads}</span>\n            </li>\n          </ul>\n        </li>\n      `\n    )\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', items);\n\n  lishtBox.refresh();\n}\n\nexport function clearElement(element) {\n  element.innerHTML = '';\n}\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAETSURBVHgBrVVbDoJADCwEwq83kaN4I+UkHgGP4mH4YTGslFBB2e0UYZImG9rO7KMtRBG0bXd1rvMW49gYTxYjTxK6eU+PNKUnKeh7Kjl2yKGiyCtCmHf+upMRHItO8je5WWQPORQ5gjwqopE7586YcB3zJTIt6kBiiR5ONtc0TRnw1ewbBbouTMLfYyJCjnJVgZgIIl/mZQSQ53k1BPNybCYGNxYb+1A+FPgVEQELOSMlI4aREFwjmE4gs4lt+mSePVBgSS7XsnwTKKJVg1YtWgkv/bDRLKWoNpoEDYShUVESQChGRsVnc5rIVqzIBUeIRMmPEIHke0Q08lUfyFjwPuE6P1l++kT+smV8jJhPgk27ljfw3ToafivEMQAAAABJRU5ErkJggg==\"","import { fetchImages } from './js/pixabay-api';\nimport { getGalleryItems, clearElement } from './js/render-functions';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport errorIco from './../assets/error.png';\n\nconst form = document.querySelector('.form');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadButton = document.querySelector('#loadMorePictures');\n// const theEndText = document.querySelector('.the-end-of-search');\n\nlet prevQuery = null;\nlet page = 1;\nconst perPage = 15;\nlet total = null;\nlet totalPages = null;\n\n// loadButton.style.display = 'none';\n// theEndText.style.display = 'none';\n\nform.addEventListener('submit', handleSubmit);\n\nasync function handleSubmit(event) {\n  event.preventDefault();\n  const query = event.currentTarget.elements['search-text'].value.trim();\n  // gallery.innerHTML = '';\n  clearElement(gallery);\n  loader.style.display = 'block';\n  loadButton.style.display = 'none';\n  page = 1;\n\n  // if (prevQuery !== query) {\n  //   page = 1;\n  // }\n\n  try {\n    if (query) {\n      const data = await fetchImages(query, page++, perPage);\n      const hits = data.hits;\n      total = data.total;\n      totalPages = Math.ceil(total / perPage);\n\n      if (!hits.length) {\n        iziToast.show(\n          getIziToastOptions(\n            'Sorry, there are no images matching your search query. Please try again!'\n          )\n        );\n      } else {\n        getGalleryItems(hits);\n\n        prevQuery = query;\n\n        if (page < totalPages) {\n          loadButton.style.display = 'block';\n          // theEndText.style.display = 'none';\n        } else {\n          // theEndText.style.display = 'block';\n          iziToast.show(\n            getIziToastOptions(\n              \"We're sorry, but you've reached the end of search results.\"\n            )\n          );\n        }\n      }\n    } else {\n      throw new Error('Invalid value.');\n    }\n  } catch (error) {\n    iziToast.show(getIziToastOptions(error.message));\n  }\n\n  loader.style.display = 'none';\n}\n\nloadButton.addEventListener('click', handleLoadButton);\n\nasync function handleLoadButton(event) {\n  loader.style.display = 'block';\n  loadButton.style.display = 'none';\n\n  const galleryCard = document.querySelector('.gallery li');\n  const scrollHeight = galleryCard.getBoundingClientRect().height * 2;\n\n  try {\n    if (page < totalPages) {\n      const data = await fetchImages(prevQuery, page++, perPage);\n      const hits = data.hits;\n      total = data.total;\n      totalPages = Math.ceil(total / perPage);\n\n      getGalleryItems(hits);\n      loadButton.style.display = 'block';\n      scrollBy(0, scrollHeight);\n    } else {\n      loadButton.style.display = 'none';\n      getIziToastOptions(\n        \"We're sorry, but you've reached the end of search results.\"\n      );\n      // theEndText.style.display = 'block';\n    }\n  } catch (error) {\n    iziToast.show(getIziToastOptions(error.message));\n  }\n  loader.style.display = 'none';\n}\n\nfunction getIziToastOptions(message) {\n  return {\n    message,\n    iconUrl: errorIco,\n    color: '#ef4040',\n    messageColor: '#fff',\n    maxWidth: '380px',\n    messageSize: '16',\n    messageLineHeight: '150%',\n    position: 'topRight',\n    iconColor: '#fff',\n  };\n}\n"],"names":["PIXABAY_BASE_URL","PIXABAY_API_KEY","axios","fetchImages","query","page","perPage","gallery","getGalleryItems","items","lishtBox","SimpleLightbox","webformatURL","largeImageURL","tags","likes","views","comments","downloads","clearElement","element","errorIco","form","loader","loadButton","prevQuery","total","totalPages","handleSubmit","event","data","hits","iziToast","getIziToastOptions","error","handleLoadButton","scrollHeight","message"],"mappings":"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"}